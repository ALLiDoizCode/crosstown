# Development override for docker-compose-bootstrap.yml
# Uses volume mounts for fast iteration (no Docker rebuilds needed)
#
# Usage:
#   docker-compose -f docker-compose-bootstrap.yml -f docker-compose-bootstrap-dev.yml up -d
#
# After code changes:
#   pnpm --filter @crosstown/bls build
#   docker-compose -f docker-compose-bootstrap.yml -f docker-compose-bootstrap-dev.yml restart crosstown-peer1 crosstown-peer2

services:
  crosstown-peer1:
    volumes:
      # Mount full built packages from host (read-only)
      # Main package dist
      - ./packages/bls/dist:/app/dist:ro
      # Workspace dependencies (need package.json + dist for module resolution)
      - ./packages/core:/app/node_modules/@crosstown/core:ro
      - ./packages/client:/app/node_modules/@crosstown/client:ro
      - ./packages/relay:/app/node_modules/@crosstown/relay:ro

  crosstown-peer2:
    volumes:
      # Same mounts for peer2
      - ./packages/bls/dist:/app/dist:ro
      - ./packages/core:/app/node_modules/@crosstown/core:ro
      - ./packages/client:/app/node_modules/@crosstown/client:ro
      - ./packages/relay:/app/node_modules/@crosstown/relay:ro
